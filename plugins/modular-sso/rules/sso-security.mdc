---
description: SAML and OIDC security standards for enterprise SSO.
alwaysApply: true
globs: ["**/*.{js,ts,py,xml}"]
---

sso-security:

- Validate SAML signatures on all responses
- Verify SAML assertion expiration timestamps
- Implement proper audience restrictions
- Use encrypted SAML assertions for sensitive data
- Validate OIDC ID tokens with proper issuer verification
- Implement proper nonce validation for OIDC
- Cache provider metadata with proper expiration

Provider integration:
- Rotate signing keys before expiration
- Validate redirect URIs against allowlist
- Implement proper state parameter validation
- Handle SLO (Single Logout) properly
