---
description: OAuth security best practices for MCP servers and agents.
alwaysApply: true
globs: ["**/*.{js,ts,py,go}"]
---

oauth-security:

- Always validate OAuth tokens before processing requests
- Implement proper token expiration and refresh logic
- Use HTTPS for all OAuth endpoints
- Validate token scopes before granting access
- Store tokens securely (encrypted at rest)
- Implement proper PKCE for public clients
- Validate redirect URIs to prevent open redirects

Token handling:
- Check token expiration before each API call
- Implement automatic token refresh with proper retry logic
- Revoke tokens on logout or session end
- Log token validation failures (without exposing sensitive data)
